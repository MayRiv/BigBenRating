<?php getView("HeaderView.inc", null); ?>
<div id="feed">
	<h1>Личный кабинет</h1>
	<?php
		//$obj->show();
		echo "<div><h2>Статистика игрока $obj->player</h2>";
		echo "<p>Получил $obj->bestVotes лучших</p>";
		echo "<p>Убит в первую ночь $obj->firstBloodCount раз</p>";
		if($obj->firstBloodCount)
			echo "<p>В среднем $obj->averageBestMove черных в лучших ходе</p></div>";
		

		echo '<body><table class="table_dark">';
		echo "<tr><th>Роль</th><th>Всего сыграно</th><th>Побед</th>";
		echo	"<tr><td>Всего</td><td>$obj->totalGamesCount</td><td>$obj->totalVictoryCount</th></td>";
		echo	"<tr><td>Красный</td><td>$obj->totalRedCountGames</td><td>$obj->totalRedVictoryGames</th></td>";
		echo	"<tr><td>Черный</td><td>$obj->totalBlackCountGames</td><td>$obj->totalBlackVictoryGames</th></td>";
		
		echo "<tr><th colspan='3'>Подробно</th></tr>";
		echo	"<tr><td>Мирный житель</td><td>$obj->citizensGameCount</td><td>$obj->citizensVictoryCount</td></tr>";
		echo	"<tr><td>Шериф</td><td>$obj->sherifGameCount</td><td>$obj->sherifVictoryCount</td></tr>";
		echo	"<tr><td>Мафия</td><td>$obj->mafiaGameCount</td><td>$obj->mafiaVictoryCount</td></tr>";
		echo	"<tr><td>Дон</td><td>$obj->donGameCount</td><td>$obj->donVictoryCount</th></td>";
		
		echo '</table>';

		echo "<div><p>Сыграл в играх: ";
		foreach ($obj->games as $game) {
			echo "<a href='?action=showGame&GameId=".$game."'>".$game."</a> ";
		}
		echo "</p></div>";
		echo '<div  style="margin:auto;"><p><noscript><strong style="color: red;">Для отображения данных необходимо включить JavaScript!</strong></noscript></p>
    <div id="placeholder" style="width:600px;height:300px;display: inline-block;"></div>
    <div style="display: inline-block;">
      <div id="legend"></div>
      <p style="postion:relative;text-align: center;"><a href="#" onclick="switch_show(); return false;">Сменить вид</a></p>
    </div>
    <div style="clear: both;"></div>
    <div id="overview" style="margin-top:20px;width:600px;height:50px;display: inline-block;"></div></div>';

		/*echo '<script language="javascript" type="text/javascript">
var all_data = [
  { label: "Все роли сыграно", color: 0, data: [["2006/01/01", 39], ["2006/02/01", 35], ["2006/03/01", 27], ["2006/04/01", 17], ["2006/05/01", 8], ["2006/06/01", 2], ["2006/07/01", 0], ["2006/08/01", 2], ["2006/09/01", 9], ["2006/10/01", 19], ["2006/11/01", 28], ["2006/12/01", 36], ["2007/01/01", 39], ["2007/02/01", 38], ["2007/03/01", 32], ["2007/04/01", 23], ["2007/05/01", 13], ["2007/06/01", 5], ["2007/07/01", 0], ["2007/08/01", 0], ["2007/09/01", 5], ["2007/10/01", 13], ["2007/11/01", 23], ["2007/12/01", 32], ["2008/01/01", 38], ["2008/02/01", 39], ["2008/03/01", 36], ["2008/04/01", 28], ["2008/05/01", 19], ["2008/06/01", 9], ["2008/07/01", 2], ["2008/08/01", 0], ["2008/09/01", 2], ["2008/10/01", 8], ["2008/11/01", 17], ["2008/12/01", 27], ["2009/01/01", 35], ["2009/02/01", 39], ["2009/03/01", 38], ["2009/04/01", 33], ["2009/05/01", 24], ["2009/06/01", 14], ["2009/07/01", 6], ["2009/08/01", 1], ["2009/09/01", 0], ["2009/10/01", 4], ["2009/11/01", 12], ["2009/12/01", 22], ["2010/01/01", 31], ["2010/02/01", 37], ["2010/03/01", 39], ["2010/04/01", 37], ["2010/05/01", 30], ["2010/06/01", 20], ["2010/07/01", 10], ["2010/08/01", 3], ["2010/09/01", 0], ["2010/10/01", 1], ["2010/11/01", 7], ["2010/12/01", 16]]},
  { label: "Все роли победы", color: 1, data: [["2006/01/01", 16], ["2006/02/01", 7], ["2006/03/01", 1], ["2006/04/01", 0], ["2006/05/01", 3], ["2006/06/01", 11], ["2006/07/01", 20], ["2006/08/01", 30], ["2006/09/01", 37], ["2006/10/01", 39], ["2006/11/01", 37], ["2006/12/01", 31], ["2007/01/01", 22], ["2007/02/01", 12], ["2007/03/01", 4], ["2007/04/01", 0], ["2007/05/01", 1], ["2007/06/01", 6], ["2007/07/01", 15], ["2007/08/01", 25], ["2007/09/01", 33], ["2007/10/01", 39], ["2007/11/01", 39], ["2007/12/01", 35], ["2008/01/01", 27], ["2008/02/01", 17], ["2008/03/01", 8], ["2008/04/01", 2], ["2008/05/01", 0], ["2008/06/01", 2], ["2008/07/01", 9], ["2008/08/01", 19], ["2008/09/01", 29], ["2008/10/01", 36], ["2008/11/01", 39], ["2008/12/01", 38], ["2009/01/01", 32], ["2009/02/01", 23], ["2009/03/01", 13], ["2009/04/01", 5], ["2009/05/01", 0], ["2009/06/01", 0], ["2009/07/01", 5], ["2009/08/01", 13], ["2009/09/01", 23], ["2009/10/01", 32], ["2009/11/01", 38], ["2009/12/01", 39], ["2010/01/01", 36], ["2010/02/01", 28], ["2010/03/01", 19], ["2010/04/01", 9], ["2010/05/01", 2], ["2010/06/01", 0], ["2010/07/01", 2], ["2010/08/01", 8], ["2010/09/01", 18], ["2010/10/01", 27], ["2010/11/01", 35], ["2010/12/01", 39]]},
  { label: "Черный", color: 2, data: [["2006/01/01", 3], ["2006/02/01", 0], ["2006/03/01", 1], ["2006/04/01", 7], ["2006/05/01", 16], ["2006/06/01", 26], ["2006/07/01", 34], ["2006/08/01", 39], ["2006/09/01", 39], ["2006/10/01", 34], ["2006/11/01", 25], ["2006/12/01", 16], ["2007/01/01", 7], ["2007/02/01", 1], ["2007/03/01", 0], ["2007/04/01", 3], ["2007/05/01", 11], ["2007/06/01", 21], ["2007/07/01", 30], ["2007/08/01", 37], ["2007/09/01", 39], ["2007/10/01", 37], ["2007/11/01", 31], ["2007/12/01", 21], ["2008/01/01", 11], ["2008/02/01", 4], ["2008/03/01", 0], ["2008/04/01", 1], ["2008/05/01", 6], ["2008/06/01", 15], ["2008/07/01", 25], ["2008/08/01", 33], ["2008/09/01", 39], ["2008/10/01", 39], ["2008/11/01", 35], ["2008/12/01", 27], ["2009/01/01", 17], ["2009/02/01", 8], ["2009/03/01", 1], ["2009/04/01", 0], ["2009/05/01", 3], ["2009/06/01", 10], ["2009/07/01", 19], ["2009/08/01", 29], ["2009/09/01", 36], ["2009/10/01", 39], ["2009/11/01", 38], ["2009/12/01", 32], ["2010/01/01", 22], ["2010/02/01", 13], ["2010/03/01", 4], ["2010/04/01", 0], ["2010/05/01", 0], ["2010/06/01", 5], ["2010/07/01", 14], ["2010/08/01", 24], ["2010/09/01", 33], ["2010/10/01", 38], ["2010/11/01", 39], ["2010/12/01", 36]]},
  { label: "Мирный", color: 3, data: [["2006/01/01", 38], ["2006/02/01", 39], ["2006/03/01", 35], ["2006/04/01", 27], ["2006/05/01", 18], ["2006/06/01", 8], ["2006/07/01", 2], ["2006/08/01", 0], ["2006/09/01", 2], ["2006/10/01", 9], ["2006/11/01", 19], ["2006/12/01", 28], ["2007/01/01", 36], ["2007/02/01", 39], ["2007/03/01", 38], ["2007/04/01", 32], ["2007/05/01", 23], ["2007/06/01", 13], ["2007/07/01", 5], ["2007/08/01", 0], ["2007/09/01", 0], ["2007/10/01", 5], ["2007/11/01", 13], ["2007/12/01", 23], ["2008/01/01", 32], ["2008/02/01", 38], ["2008/03/01", 39], ["2008/04/01", 36], ["2008/05/01", 29], ["2008/06/01", 19], ["2008/07/01", 9], ["2008/08/01", 2], ["2008/09/01", 0], ["2008/10/01", 2], ["2008/11/01", 8], ["2008/12/01", 17], ["2009/01/01", 27], ["2009/02/01", 35], ["2009/03/01", 39], ["2009/04/01", 38], ["2009/05/01", 33], ["2009/06/01", 24], ["2009/07/01", 15], ["2009/08/01", 6], ["2009/09/01", 1], ["2009/10/01", 0], ["2009/11/01", 4], ["2009/12/01", 12], ["2010/01/01", 22], ["2010/02/01", 31], ["2010/03/01", 37], ["2010/04/01", 39], ["2010/05/01", 37], ["2010/06/01", 30], ["2010/07/01", 20], ["2010/08/01", 11], ["2010/09/01", 3], ["2010/10/01", 0], ["2010/11/01", 1], ["2010/12/01", 7]]},
  { label: "Дон", color: 4, data: [["2006/01/01", 30], ["2006/02/01", 21], ["2006/03/01", 11], ["2006/04/01", 3], ["2006/05/01", 0], ["2006/06/01", 1], ["2006/07/01", 6], ["2006/08/01", 15], ["2006/09/01", 25], ["2006/10/01", 34], ["2006/11/01", 39], ["2006/12/01", 39], ["2007/01/01", 35], ["2007/02/01", 26], ["2007/03/01", 17], ["2007/04/01", 7], ["2007/05/01", 1], ["2007/06/01", 0], ["2007/07/01", 3], ["2007/08/01", 10], ["2007/09/01", 20], ["2007/10/01", 29], ["2007/11/01", 36], ["2007/12/01", 39], ["2008/01/01", 38], ["2008/02/01", 31], ["2008/03/01", 22], ["2008/04/01", 12], ["2008/05/01", 4], ["2008/06/01", 0], ["2008/07/01", 0], ["2008/08/01", 5], ["2008/09/01", 14], ["2008/10/01", 24], ["2008/11/01", 33], ["2008/12/01", 38], ["2009/01/01", 39], ["2009/02/01", 35], ["2009/03/01", 28], ["2009/04/01", 18], ["2009/05/01", 9], ["2009/06/01", 2], ["2009/07/01", 0], ["2009/08/01", 2], ["2009/09/01", 9], ["2009/10/01", 18], ["2009/11/01", 28], ["2009/12/01", 36], ["2010/01/01", 39], ["2010/02/01", 38], ["2010/03/01", 32], ["2010/04/01", 24], ["2010/05/01", 14], ["2010/06/01", 5], ["2010/07/01", 0], ["2010/08/01", 0], ["2010/09/01", 5], ["2010/10/01", 13], ["2010/11/01", 23], ["2010/12/01", 32]]} // IE не понимает запятых на конце :(
];
bbr.draw();
</script>';*/

		$games= '<script language="javascript" type="text/javascript">var all_data = [{ label: "Все роли сыграно", color: 0, data: [';
		$start = null;
		foreach ($obj->stat as $date => $stat) {
			if (!isset($start))
				$start = $date;
			$end = $date;
			$games .= "[\"$date\",".(isset($stat['general']['total'])?$stat['general']['total']:0) ."],";
		}
		$games[strlen($games) - 1] = ']';
		$games .= "},";

		$games .= '{ label: "Все роли победы", color: 0, data: [';
		foreach ($obj->stat as $date => $stat) {
			$games .= "[\"$date\",".(isset($stat['general']['victories'])?$stat['general']['victories']:0) ."],";
		}
		$games[strlen($games) - 1] = ']';
		$games .= "}];";

		echo $games;
		echo "var selection = [\"$start\", \"$end\"];";
		getView("DrawScriptRawPart.inc", null);
	?>

</script>
<p><a href="?action=changePassword">Сменить пароль</a></p>
</div>

<?php getView("Footer.inc", null); ?>
</body>